PictureMontage
==============

用数千小图拼成指定大图，是曾经看到了这样做法的图片，觉得很有意思才想自己做一个的。平台限制linux，需要OpenCV库。

效果图猛戳：http://ww3.sinaimg.cn/mw690/48e47b86tw1eezgv72rlzj20dl0gjjwv.jpg
或者http://ww2.sinaimg.cn/mw690/48e47b86tw1eezgv7oj9qj20a30bogoi.jpg

这是一个使用大量图片拼接成一幅指定图片的小程序。共有4个参数，第一个参数是素材图文件夹的路径(如~/dir)，第二个参数是所要拼接成的参考图片的路径(如~/otherdir/xx.jpg)。第三第四个参数分别与拼接块大小(如20)和匹配精度(如10)有关。
其中素材图的合适个数在10000以上最佳。

对于常见图片尺寸，以默认设置的拼接块大小20像素计算，所需的块数少则也要数千。为了保证较好的效果，在上万里面挑数千张是必要的。我的素材图来源是豆瓣相册的略缩图，为此写了一个小工具，可以批量抓取指定相册的略缩图。另外使用专辑封面或者是app icon来拼接，效果应该也是很别致的。

素材图的大小和尺寸没有限制，在读入程序中时，非正方形的图片会默认截取正中间的正方形部分，然后按比例缩小（偶尔需要放大）至以参数3所设置尺寸为大小的正方形拼接块。因此参数三直接影响了拼接的颗粒度，太大会觉得粗糙，太小会失去应有的效果，建议大小是20左右。

匹配操作选择了最简单的像素差值，但是由于匹配时的计算次数非常之巨大，所以如果把计算负担分配在匹配操作上，花费时间将会是很可观的。参数4的作用就在于控制每个拼接块在匹配前对自己的颜色信息进行一定的"浓缩"。数值越小，浓缩越大，精度越小，同时计算速度会越快。当取最大值==参数3时，会对全图像素进行差值计算，以运行速度的牺牲换取精度。

由于算法限制，参数4必须可以整除参数3（如果觉得这样的设定不够友好，可以把参数4修改为与精度相关），否则按照默认值运行。
因为种种原因，素材图可能数量不够或者质量不佳。为了保证效果，允许把素材图重复使用数次，实际经验是一旦超过三次就不好看了...建议是可以在拼接效果不好或者是数量严重不够的时候，允许重复那么一次，一张素材图可以被使用两次，这样并不会太明显。这个要在.cc文件的findRightChip函数里的第一个if里面修改然后重新编译。

同样也是出于对素材图片质量数量的鲁棒性考虑，拼接从图片中心开始，把最好的留给最重要的部分。
